<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Food By Bella</title>
  <link rel="stylesheet" href="style.css" />

</head>
<body>
  <header class="navbar">
  <div class="logo">
    <img src="my logo.png" alt="Logo" />
    <h1>Food By Bella</h1>
  </div>
  <nav class="nav-links">
    <span id="welcomeUser" style="margin-right: 20px; font-weight: bold;"></span>
    <a href="dashboard.html">Home</a>
    <a href="cart.html">Cart</a>
    <a href="order-tracking.html">Order Tracking</a>
    <button onclick="logout()" style="background:red;color:white;padding:8px 15px;border:none;border-radius:5px;cursor:pointer;">Logout</button>
  </nav>
</header>

  <div class="search-bar" style="text-align: center; margin: 20px;">
     <input type="text" id="searchInput" placeholder="Search for a meal..." style="padding: 10px; width: 60%; max-width: 400px; border-radius: 6px; border: 1px solid #ccc;">
  </div>


<div class="filter-buttons">
  <button data-category="all">All</button>
  <button data-category="rice">Rice</button>
  <button data-category="spaghetti">Spaghetti</button>
  <button data-category="soups">Soups</button>
  <button data-category="swallows">Swallows</button>
  <button data-category="proteins">Proteins</button>
  <button data-category="sides">Sides</button>
  <button data-category="drinks">Drinks</button>
</div>


  <div class="category-section rice" data-category="rice">
  <h2>üçö RICE</h2>
  <div class="section">
    <div class="meal-card">
      <img src="white-rice.jpeg" alt="White Rice" />
      <p>White Rice ‚Äì ‚Ç¶200/spoon</p>
      <button class="add-to-cart"
         data-name="White Rice"
         data-price="200"
         data-image="white-rice.jpeg">Add to Cart</button>
    </div>
    <div class="meal-card">
      <img src="jollof-rice.jpg" alt="Jollof Rice" />
      <p>Jollof Rice ‚Äì ‚Ç¶300/spoon</p>
      <button class="add-to-cart"
         data-name="Jollof Rice"
         data-price="300"
         data-image="jollof-rice.jpg">Add to Cart</button>
    </div>
    <div class="meal-card">
      <img src="fried-ricee.jpeg" alt="Fried Rice" />
      <p>Fried Rice ‚Äì ‚Ç¶300/spoon</p>
      <button class="add-to-cart"
         data-name="Fried Rice"
         data-price="300"
         data-image="fried-ricee.jpeg">Add to Cart</button>
    </div>
    <div class="meal-card">
      <img src="coconut-rice-.jpg" alt="Coconut Rice" />
      <p>Coconut Rice ‚Äì ‚Ç¶350/spoon</p>
      <button class="add-to-cart"
         data-name="Coconut Rice"
         data-price="350"
         data-image="coconut-rice-.jpg">Add to Cart</button>
    </div>
    <div class="meal-card">
      <img src="ofada.jpg" alt="Ofada Rice" />
      <p>Ofada Rice ‚Äì ‚Ç¶500/spoon</p>
      <button class="add-to-cart"
         data-name="Ofada Rice"
         data-price="500"
         data-image="ofada.jpg">Add to Cart</button>
    </div>
    <div class="meal-card">
      <img src="Asun jollof rice.jpeg" alt="Asun Jollof Rice" />
      <p>Asun Jollof Rice ‚Äì ‚Ç¶500/spoon</p>
      <button class="add-to-cart"
         data-name="Asun Jollof Rice"
         data-price="500"
         data-image="Asun jollof rice.jpeg">Add to Cart</button>
    </div>
    <div class="meal-card">
      <img src="Rice and beans.jpg" alt="Rice and Beans" />
      <p>Rice and Beans ‚Äì ‚Ç¶500/spoon</p>
      <button class="add-to-cart"
         data-name="Rice and Beans"
         data-price="500"
         data-image="Rice and beans.jpg">Add to Cart</button>
    </div>
    <div class="meal-card">
      <img src="bella special rice.jpg" alt="Bella Special Rice" />
      <p>Bella Special Rice ‚Äì ‚Ç¶500/spoon</p>
      <button class="add-to-cart"
         data-name="Bella Special Rice"
         data-price="500"
         data-image="bella special rice.jpg">Add to Cart</button>
    </div>
  </div>
  </div>

  <div class="category-section spaghetti" data-category="spaghetti">
  <h2>üçù SPAGHETTI</h2>
  <div class="section">
    <div class="meal-card">
      <img src="plain-spag.jpeg" alt="Plain Spaghetti" />
      <p>Plain Spaghetti ‚Äì ‚Ç¶200/spoon</p>
      <button class="add-to-cart"
         data-name="Plain Spaghetti"
         data-price="200"
         data-image="plain-spag.jpeg">Add to Cart</button>
    </div>
    <div class="meal-card">
      <img src="jollof spag.jpeg" alt="Jollof Spaghetti" />
      <p>Jollof Spaghetti ‚Äì ‚Ç¶300/spoon</p>
      <button class="add-to-cart"
         data-name="Jollof Spaghetti"
         data-price="300"
         data-image="jollof spag.jpeg">Add to Cart</button>
    </div>
    <div class="meal-card">
      <img src="Vegetable-Spaghetti.jpg" alt="Spaghetti with Vegetables" />
      <p>Spaghetti w/ Vegetables ‚Äì ‚Ç¶400/spoon</p>
      <button class="add-to-cart"
         data-name="Spaghetti w/ Vegetables"
         data-price="400"
         data-image="Vegetable-Spaghetti.jpg">Add to Cart</button>
    </div>
    <div class="meal-card">
      <img src="stir fry spag.jpeg" alt="Stir-fried Spaghetti" />
      <p>Stir-fried Spaghetti ‚Äì ‚Ç¶400/spoon</p>
      <button class="add-to-cart"
         data-name="Stir-fried Spaghetti"
         data-price="400"
         data-image="stir fry spag.jpeg">Add to Cart</button>
    </div>
    <div class="meal-card">
      <img src="spag w egg sauce.jpg" alt="Spaghetti with Egg Sauce" />
      <p>Spaghetti w/ Egg Sauce ‚Äì ‚Ç¶400/spoon</p>
      <button class="add-to-cart"
         data-name="Spaghetti w/ Egg Sauce"
         data-price="400"
         data-image="spag w egg sauce.jpg">Add to Cart</button>
    </div>
    <div class="meal-card">
      <img src="spaghetti-bolognese.jpg" alt="Spaghetti Bolognese" />
      <p>Spaghetti Bolognese ‚Äì ‚Ç¶400/spoon</p>
      <button class="add-to-cart"
         data-name="Spaghetti Bolognese"
         data-price="400"
         data-image="spaghetti-bolognese.jpg">Add to Cart</button>
    </div>
    <div class="meal-card">
      <img src="spaghetti carbonara.jpg" alt="Spaghetti Carbonara" />
      <p>Spaghetti Carbonara ‚Äì ‚Ç¶400/spoon</p>
      <button class="add-to-cart"
         data-name="Spaghetti Carbonara"
         data-price="400"
         data-image="spaghetti carbonara.jpg">Add to Cart</button>
    </div>
    <div class="meal-card">
      <img src="chicken spaghetti.jpg" alt="Chicken Spaghetti" />
      <p>Chicken Spaghetti ‚Äì ‚Ç¶400/spoon</p>
      <button class="add-to-cart"
         data-name="Chicken Spaghetti"
         data-price="400"
         data-image="chicken spaghetti.jpg">Add to Cart</button>
    </div>
  </div>
  </div>

  <div class="category-section soups" data-category="soups">
  <h2>üç≤ SOUPS</h2>
  <div class="section">
    <div class="meal-card">
      <img src="egusi.jpeg" alt="Egusi" />
      <p>Egusi Soup ‚Äì ‚Ç¶400</p>
      <button class="add-to-cart"
         data-name="Egusi Soup"
         data-price="400"
         data-image="egusi.jpeg">Add to Cart</button>
    </div>
    <div class="meal-card">
      <img src="ogbono.jpeg" alt="Ogbono" />
      <p>Ogbono Soup ‚Äì ‚Ç¶400</p>
      <button class="add-to-cart"
         data-name="Ogbono Soup"
         data-price="400"
         data-image="ogbono.jpeg">Add to Cart</button>
    </div>
    <div class="meal-card">
      <img src="efo-riro.jpeg" alt="Efo Riro" />
      <p>Efo Riro ‚Äì ‚Ç¶450</p>
      <button class="add-to-cart"
         data-name="Efo Riro"
         data-price="450"
         data-image="efo-riro.jpeg">Add to Cart</button>
    </div>
    <div class="meal-card">
      <img src="banga.jpeg" alt="Banga" />
      <p>Banga ‚Äì ‚Ç¶550</p>
      <button class="add-to-cart"
         data-name="Banga"
         data-price="550"
         data-image="banga.jpeg">Add to Cart</button>
    </div>
    <div class="meal-card">
      <img src="stew.jpeg" alt="Stew" />
      <p>Stew ‚Äì ‚Ç¶200</p>
      <button class="add-to-cart"
         data-name="Stew"
         data-price="200"
         data-image="stew.jpeg">Add to Cart</b>
    </div>
     <div class="meal-card">
      <img src="okro.jpeg" alt="Okro" />
      <p>Okro ‚Äì ‚Ç¶200</p>
      <button class="add-to-cart"
         data-name="Okro"
         data-price="200"
         data-image="okro.jpeg">Add to Cart</b>
    </div>
     <div class="meal-card">
      <img src="edikaikong.jpg" alt="Edikaikong" />
      <p>Edikaikong ‚Äì ‚Ç¶200</p>
      <button class="add-to-cart"
         data-name="Edikaikong"
         data-price="200"
         data-image="edikaikong.jpg">Add to Cart</b>
    </div>
     <div class="meal-card">
      <img src="afang.jpg" alt="Afang" />
      <p>Afang ‚Äì ‚Ç¶200</p>
      <button class="add-to-cart"
         data-name="Afang"
         data-price="200"
         data-image="afang.jpg">Add to Cart</b>
    </div>
  </div>
  </div>

  <div class="category-section swallows" data-category="swallows">
  <h2>üçû SWALLOWS</h2>
  <div class="section">
    <div class="meal-card">
      <img src="pounded yam.jpeg" alt="Pounded Yam" />
      <p>Pounded Yam ‚Äì ‚Ç¶300</p>
      <button class="add-to-cart"
         data-name="Pounded Yam"
         data-price="300"
         data-image="pounded yam.jpeg">Add to Cart</button>
    </div>
    <div class="meal-card">
      <img src="Amala.jpeg" alt="Amala" />
      <p>Amala ‚Äì ‚Ç¶200</p>
      <button class="add-to-cart"
         data-name="Amala"
         data-price="200"
         data-image="Amala.jpeg">Add to Cart</button>
    </div>
    <div class="meal-card">
      <img src="semo.jpeg" alt="Semo" />
      <p>Semo ‚Äì ‚Ç¶200</p>
      <button class="add-to-cart"
         data-name="Semo"
         data-price="200"
         data-image="semo.jpeg">Add to Cart</button>
    </div>
    <div class="meal-card">
      <img src="Fufu_1.jpg" alt="Fufu" />
      <p>Fufu ‚Äì ‚Ç¶200</p>
      <button class="add-to-cart"
         data-name="Fufu"
         data-price="200"
         data-image="Fufu_1.jpg">Add to Cart</button>
    </div>
  </div>
  </div>

  <div class="category-section proteins" data-category="proteins">
  <h2>üçñ PROTEINS</h2>
  <div class="section">
    <div class="meal-card">
      <img src="laps.jpg" alt="Chicken Lap" />
      <p>Chicken (Lap) ‚Äì ‚Ç¶2,500</p>
      <button class="add-to-cart"
         data-name="Chicken (Lap)"
         data-price="2500"
         data-image="laps.jpg">Add to Cart</button>
    </div>
    <div class="meal-card">
      <img src="wings.jpg" alt="Chicken Wing" />
      <p>Chicken (Wing) ‚Äì ‚Ç¶1,500</p>
      <button class="add-to-cart"
         data-name="Chicken (Wing)"
         data-price="1500"
         data-image="wings.jpg">Add to Cart</button>
    </div>
    <div class="meal-card">
      <img src="beef.jpeg" alt="Beef" />
      <p>Beef ‚Äì ‚Ç¶800</p>
      <button class="add-to-cart"
         data-name="Beef"
         data-price="800"
         data-image="beef.jpeg">Add to Cart</button>
    </div>
    <div class="meal-card">
      <img src="turkey.jpg" alt="Turkey" />
      <p>Turkey ‚Äì ‚Ç¶3,500</p>
      <button class="add-to-cart"
         data-name="Turkey"
         data-price="3500"
         data-image="turkey.jpg">Add to Cart</button>
    </div>
    <div class="meal-card">
      <img src="fish.jpeg" alt="Croaker Fish" />
      <p>Croaker Fish ‚Äì ‚Ç¶1,000</p>
      <button class="add-to-cart"
         data-name="Croaker Fish"
         data-price="1000"
         data-image="fish.jpeg">Add to Cart</button>
    </div>
    <div class="meal-card">
      <img src="titus fish.jpg" alt="Titus Fish" />
      <p>Titus Fish ‚Äì ‚Ç¶1,000</p>
      <button class="add-to-cart"
         data-name="Titus Fish"
         data-price="1000"
         data-image="titus fish.jpg">Add to Cart</button>
    </div>
    <div class="meal-card">
      <img src="eggs.jpg" alt="Egg" />
      <p>egg ‚Äì ‚Ç¶1,000</p>
      <button class="add-to-cart"
         data-name="Egg"
         data-price="1000"
         data-image="eggs.jpg">Add to Cart</button>
    </div>
    <div class="meal-card">
      <img src="Assorted Meat.jpg" alt="Assorted Meat" />
      <p>Assorted Meat ‚Äì ‚Ç¶1,000</p>
      <button class="add-to-cart"
         data-name="Assorted Meat"
         data-price="1000"
         data-image="Assorted Meat.jpg">Add to Cart</button>
    </div>
  </div>
  </div>

  <div class="category-section sides" data-category="sides">
  <h2>üçå SIDES</h2>
  <div class="section">
    <div class="meal-card">
      <img src="plantain.jpg" alt="Plantain" />
      <p>Fried Plantahin ‚Äì ‚Ç¶100</p>
      <button class="add-to-cart"
         data-name="Fried Plantain"
         data-price="100"
         data-image="plantain.jpg">Add to Cart</button>
    </div>
    <div class="meal-card">
      <img src="moi moi.jpg" alt="Moi Moi" />
      <p>Moi Moi ‚Äì ‚Ç¶400</p>
      <button class="add-to-cart"
         data-name="Moi Moi"
         data-price="400"
         data-image="moi moi.jpg">Add to Cart</button>
    </div>
    <div class="meal-card">
      <img src="salad.jpeg" alt="Salad" />
      <p>Salad ‚Äì ‚Ç¶500</p>
      <button class="add-to-cart"
         data-name="Salad"
         data-price="500"
         data-image="salad.jpeg">Add to Cart</button>
    </div>
    <div class="meal-card">
      <img src="Beans.jpeg" alt="Beans" />
      <p>Beans ‚Äì ‚Ç¶300</p>
      <button class="add-to-cart"
         data-name="Beans"
         data-price="300"
         data-image="Beans.jpeg">Add to Cart</button>
    </div>
  </div>
  </div>

  <div class="category-section drinks" data-category="drinks">
  <h2>ü•§ DRINKS</h2>
  <div class="section">
    <div class="meal-card">
      <img src="coke.jpeg" alt="Coke" />
      <p>Coke ‚Äì ‚Ç¶500</p>
      <button class="add-to-cart"
        data-name="Coke"
         data-price="500"
         data-image="coke.jpeg">Add to Cart</button>
    </div>
    <div class="meal-card">
      <img src="water.jpeg" alt="Water" />
      <p>Water ‚Äì ‚Ç¶300</p>
      <button class="add-to-cart"
         data-name="Water"
         data-price="300"
         data-image="water.jpeg">Add to Cart</button>
    </div>
    <div class="meal-card">
      <img src="5alive.jpeg" alt="5Alive" />
      <p>5Alive ‚Äì ‚Ç¶1,200</p>
      <button class="add-to-cart"
         data-name="5Alive"
         data-price="1200"
         data-image="5alive.jpeg">Add to Cart</button>
    </div>
    <div class="meal-card">
      <img src="malt.jpeg" alt="Malt" />
      <p>Malt ‚Äì ‚Ç¶800</p>
      <button class="add-to-cart"
         data-name="Malt"
         data-price="800"
         data-image="malt.jpeg">Add to Cart</button>
    </div>
    <div class="meal-card">
      <img src="fanta.jpg" alt="Fanta" />
      <p>Fanta ‚Äì ‚Ç¶500</p>
      <button class="add-to-cart"
         data-name="Fanta"
         data-price="500"
         data-image="fanta.jpg">Add to Cart</button>
    </div>
     <div class="meal-card">
      <img src="hollandia yoghurt.png" alt="Hollandia Yoghurt" />
      <p>Hollandia Yoghurt ‚Äì ‚Ç¶500</p>
      <button class="add-to-cart"
         data-name="Hollandia Yoghurt"
         data-price="500"
         data-image="hollandia yoghurt.png">Add to Cart</button>
    </div>
     <div class="meal-card">
      <img src="monster.jpeg" alt="Monster Energy" />
      <p>Monster Energy ‚Äì ‚Ç¶500</p>
      <button class="add-to-cart"
         data-name="Monster Energy"
         data-price="500"
         data-image="monster.jpeg">Add to Cart</button>
    </div>
     <div class="meal-card">
      <img src="Chi active.jpeg" alt="Chi active" />
      <p>Chi Active ‚Äì ‚Ç¶500</p>
      <button class="add-to-cart"
         data-name="Chi Active"
         data-price="500"
         data-image="Chi active.jpeg">Add to Cart</button>
    </div>
  </div>
  </div>
</body>
</html>
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.13.0/firebase-app.js";
  import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.13.0/firebase-auth.js";
  import { getFirestore, doc, getDoc, setDoc } from "https://www.gstatic.com/firebasejs/10.13.0/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyAM6Aw5rI5ysxlJ8osuozlV1OdVy3QqJJ4",
    authDomain: "my-restaurant-app-8c40b.firebaseapp.com",
    projectId: "my-restaurant-app-8c40b",
    storageBucket: "my-restaurant-app-8c40b.firebasestorage.app",
    messagingSenderId: "744991278655",
    appId: "1:744991278655:web:a3c4975525c5f9d57f5a8a"
  };

  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  const db = getFirestore(app);

  let currentUid = null;
  let currentUsername = null;

  onAuthStateChanged(auth, async (user) => {
    if (!user) {
      alert("You must log in first!");
      window.location.href = "login.html";
      return;
    }

    currentUid = user.uid;

    const userRef = doc(db, "users", currentUid);
    const snap = await getDoc(userRef);

    if (!snap.exists()) {
      alert("Profile not found. Please sign up again.");
      await signOut(auth);
      window.location.href = "signup.html";
      return;
    }

    const data = snap.data();
    currentUsername = data.username || user.email;
    document.getElementById("welcomeUser").textContent = `Welcome, ${currentUsername}`;

    initCartButtons();
  });

async function addToCart(name, price, image) {
  const cartRef = doc(db, "carts", currentUid);
  const cartSnap = await getDoc(cartRef);

  let cartData = { items: [] };

  if (cartSnap.exists()) {
    cartData = cartSnap.data();
  }

  if (!cartData.items) {
    cartData.items = [];
  }

  const existingIndex = cartData.items.findIndex(i => i.name === name);

  if (existingIndex > -1) {
    cartData.items[existingIndex].quantity += 1;
  } else {
    cartData.items.push({
      name,
      price,
      image,
      quantity: 1
    });
  }

  await setDoc(cartRef, cartData);

  alert("‚úÖ Item added to cart!");
}


  function initCartButtons() {
    document.body.addEventListener("click", (e) => {
      if (e.target.classList.contains("add-to-cart")) {
        const name = e.target.dataset.name;
        const price = e.target.dataset.price;
        const image = e.target.dataset.image;

        if (!name || !price) {
          alert("‚ùå Missing product details. Please check the button's dataset.");
          console.error("Dataset missing:", e.target.dataset);
          return;
        }

        addToCart(name, price, image);
      }
    });
  }

function initSearchAndFilters() {
  const filterButtons = document.querySelectorAll(".filter-buttons button");
  const categorySections = document.querySelectorAll(".category-section");
  const searchInput = document.getElementById("searchInput");

  filterButtons.forEach(button => {
    button.addEventListener("click", () => {
      const selected = button.getAttribute("data-category");
      categorySections.forEach(section => {
        const cat = section.getAttribute("data-category");
        section.style.display = (selected === "all" || cat === selected) ? "block" : "none";
      });
    });
  });

  searchInput?.addEventListener("input", function () {
    const term = this.value.toLowerCase();

    categorySections.forEach(section => {
      let matchFound = false;

      section.querySelectorAll(".meal-card").forEach(card => {
        const mealName = card.querySelector("p")?.textContent.toLowerCase() || "";
        if (mealName.includes(term)) {
          card.style.display = "block";
          matchFound = true;
        } else {
          card.style.display = "none";
        }
      });

      section.style.display = matchFound ? "block" : "none";
    });
  });
}

document.addEventListener("DOMContentLoaded", initSearchAndFilters);


  window.logout = function () {
    if (confirm("Are you sure you want to logout?")) {
      signOut(auth).then(() => {
        window.location.href = "login.html";
      }).catch((error) => {
        console.error("Logout error:", error);
        alert("Failed to logout, please try again.");
      });
    }
  }
</script>
